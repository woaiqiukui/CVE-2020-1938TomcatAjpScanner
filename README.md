# CVE-2020-1938TomcatAjpScanner
批量扫描TomcatAJP漏洞

### 漏洞详情
2020年1月6日，国家信息安全漏洞共享平台（CNVD）收录了Apache Tomcat文件包含漏洞（CNVD-2020-10487，对应CVE-2020-1938）。攻击者利用该漏洞，可在未授权的情况下远程读取特定目录下的任意文件。目前，漏洞细节尚未公开，厂商已发布新版本完成漏洞修复。

### 漏洞分析
https://mp.weixin.qq.com/s/8Wueh4lkKBtfNisjxOSoWA

### 脚本使用
python CVE-2020-1938TomcatAjpScanner -h         可以查看使用说明
usage: CVE-2020-1938TomcatAjpScanner.py [-h] [-p PORT] [-f FILE] [-z ZIZHAN]
                                        target

使用方法：python CVE-2020-1938TomcatAjpScanner.py target [-p port]
其中target为ip地址，形式可以为字符串或者文件； 扫描结果将存放在当前路径下的result.txt中 支持python3

positional arguments:
  target                Hostname or IP to attack---Support Inputting a txt
                        file

optional arguments:
  -h, --help            show this help message and exit
  -p PORT, --port PORT  AJP port to attack (default is 8009)
  -f FILE, --file FILE  file path :(WEB-INF/web.xml)
  -z ZIZHAN, --zizhan ZIZHAN
                        zizhan path :(woaiqiukui)
                        
[!]注意：使用时注意文件名冲突问题，为防止出现内容冲突，重复使用时请提前手动清空result.txt文件
[!]注意：请注意传递的ip的正确格式，不要传递一个目录
                        
### 使用演示
##### 这里使用的是本地搭建的apache-tomcat-7.0.86
* usage:  
![image](https://github.com/CleanBulking/CVE-2020-1938TomcatAjpScanner/blob/images/usage.png)  

* test.txt:  
![image](https://github.com/CleanBulking/CVE-2020-1938TomcatAjpScanner/blob/images/test.txt.png)  

* display:  
![image](https://github.com/CleanBulking/CVE-2020-1938TomcatAjpScanner/blob/images/display.png)  

* result.txt:  
![image](https://github.com/CleanBulking/CVE-2020-1938TomcatAjpScanner/blob/images/result.txt.png)
